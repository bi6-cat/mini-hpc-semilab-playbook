---

- name: 05 - Login GUI (XFCE + X2Go)
  hosts: login
  gather_facts: true
  become: true

  pre_tasks:
    - name: Verify network connectivity
      ansible.builtin.ping:

    - name: Validate GUI is enabled
      ansible.builtin.assert:
        that:
          - gui_enabled | default(false) | bool
        fail_msg: "GUI not enabled for this host (set gui_enabled: true)"

  roles:
    - login-limits
    - login-gui


- name: 05 - Configure User Groups on FreeIPA
  hosts: head
  become: true
  gather_facts: true
  
  roles:
    - role: identity
      tags:
        - identity
        - user-groups


- name: 05 - Verify User Groups Configuration
  hosts: head
  become: true
  gather_facts: false
  
  roles:
    - ipa-verify
